---
title: "Preventing data theft : Galera edition"
date: Wed, 12 Mar 2025 15:54:32 GMT
lastUpdated: 2025-03-12T15:54:32.142Z
link: https://medium.com/@arbaudie.it/preventing-data-theft-galera-edition-28c1b0362f4d?source=rss-c779d007e7fe------2
---

<h3>Preventing data theft : Galera edition</h3><p><a href="https://galeracluster.com/products/">Galera Cluster</a> is a synchronous multi-master replication solution for MySQL, MariaDB, and Percona XtraDB. It offers high availability and data consistency across multiple database nodes. While <a href="https://mariadb.com/kb/en/getting-started-with-mariadb-galera-cluster/">built into MariaDB</a> server, it remains a separate third-party library for MySQL and Percona XtraDB.</p><p>Many believe that securing data streams with TLS and encrypting data-at-rest (<a href="https://galeracluster.com/2023/04/using-gcache-encryption-in-galera-cluster-enterprise-edition-ee/">GCache encryption included in the Enterprise version</a>) is sufficient for data security. However, a core feature can be exploited to steal data from an unsuspecting cluster.</p><p>Snapshot State Transfert (SST) is a fundamental mechanism in Galera Cluster that enables full data synchronization between nodes. It’s triggered when a new node joins the cluster or a node needs full resynchronization. The process involves transferring a complete database copy from an existing cluster node (the donor) to the joining node (the joiner).</p><p>Surprisingly, triggering an SST only requires a machine running a compatible version of MariaDB/MySQL/Percona server and a network route to one cluster node. Once these conditions are met, launching a rogue database service and waiting for it to start is sufficient.</p><figure><img alt="" src="https://cdn-images-1.medium.com/max/971/1*tZLN0A4A36ppO6fNCu-99A.png" /><figcaption>Galera SST process</figcaption></figure><p>Internally, Galera has no way to verify if a candidate node is legitimate. Once accepted into the cluster, data encryption becomes ineffective in preventing data transfer. While firewalls and TLS certificate validation can help, they’re not foolproof, especially against <a href="https://www.stationx.net/insider-threat-statistics/">insider threats</a>. Those insider threats have been on the rise up to <a href="https://www.stationx.net/data-breach-statistics/">representing 35% of data breaches in 2024</a>. 2025 should confirm the trend. <a href="https://mariadb.com/kb/en/mariadb-10100-release-notes/#galera">MariaDB Server 10.10</a> and newer versions introduced a new system table: <a href="https://galeracluster.com/2024/03/mariadb-galera-cluster-the-wsrep-allowlist/">wsrep_allow_list</a>. This table stores allowed IP addresses. When a node requests an SST, its IP is checked against this list. Only listed IPs are served; others receive a failure message:</p><pre>2024-03-18  8:19:14 0 [ERROR] WSREP: failed to open gcomm backend connection: 110: failed to reach primary view: 110 (Connection timed out) at ./gcomm/src/pc.cpp:connect():160<br />2024-03-18  8:19:14 0 [ERROR] WSREP: ./gcs/src/gcs_core.cpp:gcs_core_open():221: Failed to open backend connection: -110 (Connection timed out)<br />2024-03-18  8:19:15 0 [ERROR] WSREP: ./gcs/src/gcs.cpp:gcs_open():1674: Failed to open channel 'mariadb' at 'gcomm://18.194.147.243,18.193.102.155': -110 (Connection timed out)<br />2024-03-18  8:19:15 0 [ERROR] WSREP: gcs connect failed: Connection timed out</pre><p>Donor nodes log violations:</p><pre>2024-03-18  8:19:02 0 [Warning] WSREP: Connection not allowed, IP 3.70.155.51 not found in allowlist.</pre><p>This feature adds an extra layer of security against unauthorized SST requests.</p><p>Securing a Galera Cluster requires more than just encryption; it demands proactive measures like IP whitelisting and vigilant monitoring to prevent exploitation of its core features. While advancements like the wsrep_allow_list in MariaDB 10.10 offer hope, it’s up to administrators to implement these tools effectively. What are your thoughts on balancing functionality and security in database clustering? Let’s discuss!</p><img alt="" height="1" src="https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=28c1b0362f4d" width="1" />
