---
title: "Preventing data theft : Galera edition"
date: Wed, 12 Mar 2025 15:54:32 GMT
lastUpdated: 2025-03-12T15:54:32.142Z
link: https://medium.com/@arbaudie.it/preventing-data-theft-galera-edition-28c1b0362f4d?source=rss-c779d007e7fe------2
---

<article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fv gl gm gn go gp"></div><div class="gq gr gs gt gu"><div class="ab cd"><div class="ck bh gc gd ge gf"><div><h1 class="pw-post-title gv gw gx bf gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx bk" data-testid="storyTitle" id="9447">Preventing data theft : Galera edition</h1><div><div class="speechify-ignore ab cr"><div class="speechify-ignore bh l"><div class="hy hz ia ib ic ab"><div><div class="ab id"><div><div aria-hidden="false" class="bm"><a href="/@arbaudie.it?source=post_page---byline--28c1b0362f4d---------------------------------------" rel="noopener follow"><div class="l ie if by ig ih"><div class="l fm"><img alt="The consistent voice" class="l ff by df dg cz" data-testid="authorPhoto" height="44" loading="lazy" src="https://miro.medium.com/v2/da:true/resize:fill:88:88/0*7vBG_L_kSIeOh095" width="44"/><div class="ii by l df dg fv n ij fw"></div></div></div></a></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="ik ab q"><div class="ab q il"><div class="ab q"><div><div aria-hidden="false" class="bm"><p class="bf b im in bk"><a class="ag ah ai aj ak al am an ao ap aq ar as io" data-testid="authorName" href="/@arbaudie.it?source=post_page---byline--28c1b0362f4d---------------------------------------" rel="noopener follow">The consistent voice</a></p></div></div></div><span aria-hidden="true" class="ip iq"><span class="bf b bg z bk">·</span></span><p class="bf b im in bk"><span><a class="ag ah ai aj ak al am an ao ap aq ar as ir" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc779d007e7fe%2F28c1b0362f4d&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40arbaudie.it%2Fpreventing-data-theft-galera-edition-28c1b0362f4d&amp;user=The+consistent+voice&amp;userId=c779d007e7fe&amp;source=post_page-c779d007e7fe--byline--28c1b0362f4d---------------------post_header------------------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l cb"><span class="bf b bg z dw"><div class="ab cp is it iu"><span class="bf b bg z dw"><div class="ab ae"><span data-testid="storyReadTime">2 min read</span><div aria-hidden="true" class="iv iw l"><span aria-hidden="true" class="l"><span class="bf b bg z dw">·</span></span></div><span data-testid="storyPublishDate">Mar 12, 2025</span></div></span></div></span></div></div></div><div class="ab cr ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm"><div class="h k w fj fk q"><div class="kc l"><div class="ab q kd ke"><div class="pw-multi-vote-icon fm kf kg kh ki"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="headerClapButton" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F28c1b0362f4d&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40arbaudie.it%2Fpreventing-data-theft-galera-edition-28c1b0362f4d&amp;user=The+consistent+voice&amp;userId=c779d007e7fe&amp;source=---header_actions--28c1b0362f4d---------------------clap_footer------------------" rel="noopener follow"><div><div aria-hidden="false" class="bm"><div class="kj ap kk kl km kn an ko kp kq ki"><svg aria-label="clap" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" fill-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l kr ks kt ku kv kw kx"><p class="bf b dx z dw"><span class="ky">--</span></p></div></div></div><div><div aria-hidden="false" class="bm"><button aria-label="responses" class="ap kj kz la ab q fn lb lc"><svg class="ld" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q jn jo jp jq jr js jt ju jv jw jx jy jz ka kb"><div class="le k j i d"></div><div class="h k"><div><div aria-hidden="false" class="bm"><span><a class="ag ah ai aj ak al am an ao ap aq ar as at au" data-testid="headerBookmarkButton" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F28c1b0362f4d&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40arbaudie.it%2Fpreventing-data-theft-galera-edition-28c1b0362f4d&amp;source=---header_actions--28c1b0362f4d---------------------bookmark_footer------------------" rel="noopener follow"><svg aria-label="Add to list bookmark button" class="dw lf" fill="none" height="25" viewbox="0 0 25 25" width="25" xmlns="http://www.w3.org/2000/svg"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z" fill="currentColor"></path></svg></a></span></div></div></div><div class="ff lg cp"><div class="l ae"><div class="ab cd"><div class="lh li lj lk ll lm ck bh"><div class="ab"><div aria-hidden="false" class="bm"><div><div aria-hidden="false" class="bm"><button aria-label="Listen" class="ag fn ai aj ak al am ln ao ap aq ez lo lp lc lq lr ls lt lu s lv lw lx ly lz ma mb u mc md me" data-testid="audioPlayButton"><svg fill="none" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" fill="currentColor" fill-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z dw">Listen</p></div></button></div></div></div></div></div></div></div></div><div aria-describedby="postFooterSocialMenu" aria-hidden="false" aria-labelledby="postFooterSocialMenu" class="bm"><div><div aria-hidden="false" class="bm"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" class="ag fn ai aj ak al am ln ao ap aq ez lo lp lc lq lr ls lt lu s lv lw lx ly lz ma mb u mc md me" data-testid="headerSocialShareButton"><svg fill="none" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" fill="currentColor" fill-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z dw">Share</p></div></button></div></div></div></div></div></div></div></div></div><p class="pw-post-body-paragraph mf mg gx mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gq bk" id="11b9"><a class="ag ir" href="https://galeracluster.com/products/" rel="noopener ugc nofollow" target="_blank">Galera Cluster</a> is a synchronous multi-master replication solution for MySQL, MariaDB, and Percona XtraDB. It offers high availability and data consistency across multiple database nodes. While <a class="ag ir" href="https://mariadb.com/kb/en/getting-started-with-mariadb-galera-cluster/" rel="noopener ugc nofollow" target="_blank">built into MariaDB</a> server, it remains a separate third-party library for MySQL and Percona XtraDB.</p><p class="pw-post-body-paragraph mf mg gx mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gq bk" id="4e28">Many believe that securing data streams with TLS and encrypting data-at-rest (<a class="ag ir" href="https://galeracluster.com/2023/04/using-gcache-encryption-in-galera-cluster-enterprise-edition-ee/" rel="noopener ugc nofollow" target="_blank">GCache encryption included in the Enterprise version</a>) is sufficient for data security. However, a core feature can be exploited to steal data from an unsuspecting cluster.</p><p class="pw-post-body-paragraph mf mg gx mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gq bk" id="23e7">Snapshot State Transfert (SST) is a fundamental mechanism in Galera Cluster that enables full data synchronization between nodes. It’s triggered when a new node joins the cluster or a node needs full resynchronization. The process involves transferring a complete database copy from an existing cluster node (the donor) to the joining node (the joiner).</p><p class="pw-post-body-paragraph mf mg gx mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gq bk" id="cf1a">Surprisingly, triggering an SST only requires a machine running a compatible version of MariaDB/MySQL/Percona server and a network route to one cluster node. Once these conditions are met, launching a rogue database service and waiting for it to start is sufficient.</p><figure class="ng nh ni nj nk nl nd ne paragraph-image"><div class="nm nn fm no bh np" role="button" tabindex="0"><div class="nd ne nf"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*tZLN0A4A36ppO6fNCu-99A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*tZLN0A4A36ppO6fNCu-99A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*tZLN0A4A36ppO6fNCu-99A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*tZLN0A4A36ppO6fNCu-99A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*tZLN0A4A36ppO6fNCu-99A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*tZLN0A4A36ppO6fNCu-99A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tZLN0A4A36ppO6fNCu-99A.png 1400w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" srcset="https://miro.medium.com/v2/resize:fit:640/1*tZLN0A4A36ppO6fNCu-99A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*tZLN0A4A36ppO6fNCu-99A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*tZLN0A4A36ppO6fNCu-99A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*tZLN0A4A36ppO6fNCu-99A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*tZLN0A4A36ppO6fNCu-99A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*tZLN0A4A36ppO6fNCu-99A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*tZLN0A4A36ppO6fNCu-99A.png 1400w"/><img alt="" class="bh lm nq c" height="440" loading="eager" role="presentation" width="700"/></picture></div></div><figcaption class="nr fh ns nd ne nt nu bf b bg z dw">Galera SST process</figcaption></figure><p class="pw-post-body-paragraph mf mg gx mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gq bk" id="aac8">Internally, Galera has no way to verify if a candidate node is legitimate. Once accepted into the cluster, data encryption becomes ineffective in preventing data transfer. While firewalls and TLS certificate validation can help, they’re not foolproof, especially against <a class="ag ir" href="https://www.stationx.net/insider-threat-statistics/" rel="noopener ugc nofollow" target="_blank">insider threats</a>. Those insider threats have been on the rise up to <a class="ag ir" href="https://www.stationx.net/data-breach-statistics/" rel="noopener ugc nofollow" target="_blank">representing 35% of data breaches in 2024</a>. 2025 should confirm the trend. <a class="ag ir" href="https://mariadb.com/kb/en/mariadb-10100-release-notes/#galera" rel="noopener ugc nofollow" target="_blank">MariaDB Server 10.10</a> and newer versions introduced a new system table: <code class="cz nv nw nx ny b"><a class="ag ir" href="https://galeracluster.com/2024/03/mariadb-galera-cluster-the-wsrep-allowlist/" rel="noopener ugc nofollow" target="_blank">wsrep_allow_list</a></code>. This table stores allowed IP addresses. When a node requests an SST, its IP is checked against this list. Only listed IPs are served; others receive a failure message:</p><pre class="ng nh ni nj nk nz ny oa bp ob bb bk"><span class="oc od gx ny b bg oe of l og oh" id="877a">2024-03-18  8:19:14 0 [ERROR] WSREP: failed to open gcomm backend connection: 110: failed to reach primary view: 110 (Connection timed out) at ./gcomm/src/pc.cpp:connect():160<br/>2024-03-18  8:19:14 0 [ERROR] WSREP: ./gcs/src/gcs_core.cpp:gcs_core_open():221: Failed to open backend connection: -110 (Connection timed out)<br/>2024-03-18  8:19:15 0 [ERROR] WSREP: ./gcs/src/gcs.cpp:gcs_open():1674: Failed to open channel 'mariadb' at 'gcomm://18.194.147.243,18.193.102.155': -110 (Connection timed out)<br/>2024-03-18  8:19:15 0 [ERROR] WSREP: gcs connect failed: Connection timed out</span></pre><p class="pw-post-body-paragraph mf mg gx mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gq bk" id="a28f">Donor nodes log violations:</p><pre class="ng nh ni nj nk nz ny oa bp ob bb bk"><span class="oc od gx ny b bg oe of l og oh" id="88b6">2024-03-18  8:19:02 0 [Warning] WSREP: Connection not allowed, IP 3.70.155.51 not found in allowlist.</span></pre><p class="pw-post-body-paragraph mf mg gx mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gq bk" id="0606">This feature adds an extra layer of security against unauthorized SST requests.</p><p class="pw-post-body-paragraph mf mg gx mh b mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc gq bk" id="15c0">Securing a Galera Cluster requires more than just encryption; it demands proactive measures like IP whitelisting and vigilant monitoring to prevent exploitation of its core features. While advancements like the <code class="cz nv nw nx ny b">wsrep_allow_list</code> in MariaDB 10.10 offer hope, it’s up to administrators to implement these tools effectively. What are your thoughts on balancing functionality and security in database clustering? Let’s discuss!</p></div></div></div></div></section></div></div></article>
