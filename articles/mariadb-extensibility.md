---
title: "MariaDB extensibility"
date: Wed, 27 Nov 2024 13:17:50 GMT
lastUpdated: 2024-11-27T13:38:34.361Z
link: https://medium.com/@arbaudie.it/mariadb-extensibility-dce50baece54?source=rss-c779d007e7fe------2
---

<article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle" id="3f6c">Enhancing MariaDB’s Capabilities: Exploring Extensibility Options</h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><div><div aria-hidden="false" class="bm"><a href="/@arbaudie.it?source=post_page---byline--dce50baece54---------------------------------------" rel="noopener follow"><div class="l ib ic by id ie"><div class="l fj"><img alt="The consistent voice" class="l fd by dd de cx" data-testid="authorPhoto" height="44" loading="lazy" src="https://miro.medium.com/v2/da:true/resize:fill:88:88/0*7vBG_L_kSIeOh095" width="44"/><div class="if by l dd de fs n ig ft"></div></div></div></a></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="ih ab q"><div class="ab q ii"><div class="ab q"><div><div aria-hidden="false" class="bm"><p class="bf b ij ik bk"><a class="af ag ah ai aj ak al am an ao ap aq ar il" data-testid="authorName" href="/@arbaudie.it?source=post_page---byline--dce50baece54---------------------------------------" rel="noopener follow">The consistent voice</a></p></div></div></div><span aria-hidden="true" class="im in"><span class="bf b bg z bk">·</span></span><p class="bf b ij ik bk"><span><a class="af ag ah ai aj ak al am an ao ap aq ar io" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fc779d007e7fe&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40arbaudie.it%2Fmariadb-extensibility-dce50baece54&amp;user=The+consistent+voice&amp;userId=c779d007e7fe&amp;source=post_page-c779d007e7fe--byline--dce50baece54---------------------post_header------------------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l ip"><span class="bf b bg z du"><div class="ab cn iq ir is"><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">5 min read</span><div aria-hidden="true" class="it iu l"><span aria-hidden="true" class="l"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">Nov 27, 2024</span></div></span></div></span></div></div></div><div class="ab cp iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk"><div class="h k w fg fh q"><div class="ka l"><div class="ab q kb kc"><div class="pw-multi-vote-icon fj kd ke kf kg"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fdce50baece54&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40arbaudie.it%2Fmariadb-extensibility-dce50baece54&amp;user=The+consistent+voice&amp;userId=c779d007e7fe&amp;source=---header_actions--dce50baece54---------------------clap_footer------------------" rel="noopener follow"><div><div aria-hidden="false" class="bm"><div class="kh ao ki kj kk kl am km kn ko kg"><svg aria-label="clap" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" fill-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l kp kq kr ks kt ku kv"><p class="bf b dv z du"><span class="kw">--</span></p></div></div></div><div><div aria-hidden="false" class="bm"><button aria-label="responses" class="ao kh kx ky ab q fk kz la"><svg class="lb" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q jl jm jn jo jp jq jr js jt ju jv jw jx jy jz"><div class="lc k j i d"></div><div class="h k"><div><div aria-hidden="false" class="bm"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fdce50baece54&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40arbaudie.it%2Fmariadb-extensibility-dce50baece54&amp;source=---header_actions--dce50baece54---------------------bookmark_footer------------------" rel="noopener follow"><svg aria-label="Add to list bookmark button" class="du ld" fill="none" height="25" viewbox="0 0 25 25" width="25" xmlns="http://www.w3.org/2000/svg"><path d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z" fill="currentColor"></path></svg></a></span></div></div></div><div class="fd le cn"><div class="l ae"><div class="ab cb"><div class="lf lg lh li lj lk ci bh"><div class="ab"><div aria-hidden="false" class="bm"><div><div aria-hidden="false" class="bm"><button aria-label="Listen" class="af fk ah ai aj ak al ll an ao ap ex lm ln la lo lp lq lr ls s lt lu lv lw lx ly lz u ma mb mc" data-testid="audioPlayButton"><svg fill="none" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" fill="currentColor" fill-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div aria-describedby="postFooterSocialMenu" aria-hidden="false" aria-labelledby="postFooterSocialMenu" class="bm"><div><div aria-hidden="false" class="bm"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" class="af fk ah ai aj ak al ll an ao ap ex lm ln la lo lp lq lr ls s lt lu lv lw lx ly lz u ma mb mc" data-testid="headerSocialShareButton"><svg fill="none" height="24" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" fill="currentColor" fill-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><p class="pw-post-body-paragraph md me gu mf b mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na gn bk" id="4cfd">MariaDB, a powerful open-source database system, offers a versatile feature that many developers overlook: User-Defined Functions (UDFs). This capability, inherited from MySQL’s early days (around 25 years ago in version 3.21.24), allows you to extend the database’s functionality in ways that can significantly enhance your applications. Let’s explore the world of UDFs and uncover how they can revolutionize your database operations using a real life use case.</p></div></div></div><div class="ab cb nb nc nd ne" role="separator"><span class="nf by bm ng nh ni"></span><span class="nf by bm ng nh ni"></span><span class="nf by bm ng nh"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><p class="pw-post-body-paragraph md me gu mf b mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na gn bk" id="f2c9"><a class="af io" href="https://mariadb.com/kb/en/user-defined-functions/" rel="noopener ugc nofollow" target="_blank">User-defined functions</a> (UDFs) in MariaDB are custom functions created by users to extend the database’s native functionality. These functions are compiled functions loaded from dynamic binaries written in high level languages. They behave just like built-in functions.</p><p class="pw-post-body-paragraph md me gu mf b mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na gn bk" id="45dc">UDFs are particularly beneficial in scenarios where high performance is crucial, such as when executing complex mathematical computations or integrating specialized algorithms that would be inefficient in pure SQL. They are also useful when existing built-in functions do not meet specific application requirements, allowing developers to incorporate custom logic seamlessly into their database operations. UDFs are ideal for applications that require direct interaction with external libraries or systems, providing a bridge between the database and other software components. However, due to their complexity and security considerations, UDFs should be used when the benefits of custom functionality outweigh the challenges of implementation and maintenance.</p><p class="pw-post-body-paragraph md me gu mf b mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na gn bk" id="d5f2">Security wise there are several things to care for :</p><ul class=""><li class="md me gu mf b mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nj nk nl bk" id="5849">UDFs means executing arbitrary binary code in the database kernel. So it’s crucial to have complete control over the code,</li><li class="md me gu mf b mg nm mi mj mk nn mm mn mo no mq mr ms np mu mv mw nq my mz na nj nk nl bk" id="c35c">UDFs are kernel loaded binaries so crashing means the whole MariaDB server crash along with it,</li><li class="md me gu mf b mg nm mi mj mk nn mm mn mo no mq mr ms np mu mv mw nq my mz na nj nk nl bk" id="7f22">UDFs can be used for generated columns but it’s up to the DBA to ensure about the deterministic nature of the called UDF since MariaDB has no way to check,</li><li class="md me gu mf b mg nm mi mj mk nn mm mn mo no mq mr ms np mu mv mw nq my mz na nj nk nl bk" id="4bbd">UDFs are unsafe for SBR by default. So UDFs make RBR mandatory.</li></ul></div></div></div><div class="ab cb nb nc nd ne" role="separator"><span class="nf by bm ng nh ni"></span><span class="nf by bm ng nh ni"></span><span class="nf by bm ng nh"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h2 class="nr ns gu bf nt nu nv dy nw nx ny ea nz mo oa ob oc ms od oe of mw og oh oi oj bk" id="6552">UDF API from the C library perspective</h2><pre class="ok ol om on oo op oq or bp os bb bk"><span class="ot ns gu oq b bg ou ov l ow ox" id="0234">// initialize start of query execution to setup context<br/>my_bool name_init(UDF_INIT *initd, UDF_ARGS *args, char *message)</span></pre><ul class=""><li class="md me gu mf b mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nj nk nl bk" id="28c4"><em class="oy">initd</em> : supplies MariaDB with the return metadata</li><li class="md me gu mf b mg nm mi mj mk nn mm mn mo no mq mr ms np mu mv mw nq my mz na nj nk nl bk" id="e2eb"><em class="oy">args</em> : MariaDB provides the argument metadata</li><li class="md me gu mf b mg nm mi mj mk nn mm mn mo no mq mr ms np mu mv mw nq my mz na nj nk nl bk" id="740c"><em class="oy">message</em> : a pointer to add an error message</li><li class="md me gu mf b mg nm mi mj mk nn mm mn mo no mq mr ms np mu mv mw nq my mz na nj nk nl bk" id="623a"><em class="oy">return</em> : 0 for success, 1 for error</li></ul><pre class="ok ol om on oo op oq or bp os bb bk"><span class="ot ns gu oq b bg ou ov l ow ox" id="490d">// cleanup at the end of the query execution<br/>void name_deinit(UDF_INIT *initd)</span></pre><ul class=""><li class="md me gu mf b mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nj nk nl bk" id="a5aa"><em class="oy">initd</em> : metadata defined in the init call</li></ul><pre class="ok ol om on oo op oq or bp os bb bk"><span class="ot ns gu oq b bg ou ov l ow ox" id="568a">// function called on every row<br/><br/>// string based function :<br/>char *name(UDF_INIT *initd, UDF_ARGS *args, char *result, unsigned long *lenghth, char *is_null, char *error)<br/><br/>// numeric based function : <br/>long long name(UDF_INIT *initd, UDF_ARGS *args, char *is_null, char *error)<br/><br/>//float based function :<br/>double name(UDF_INIT *initd, UDF_ARGS *args, char *is_null, char *error)</span></pre><ul class=""><li class="md me gu mf b mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nj nk nl bk" id="41c7"><em class="oy">initd</em> : init-time metadata</li><li class="md me gu mf b mg nm mi mj mk nn mm mn mo no mq mr ms np mu mv mw nq my mz na nj nk nl bk" id="409c"><em class="oy">args</em> : input arguments</li><li class="md me gu mf b mg nm mi mj mk nn mm mn mo no mq mr ms np mu mv mw nq my mz na nj nk nl bk" id="518d"><em class="oy">result</em> : an optional pre-allocated 768 byte buffer</li><li class="md me gu mf b mg nm mi mj mk nn mm mn mo no mq mr ms np mu mv mw nq my mz na nj nk nl bk" id="63ac"><em class="oy">length</em> : length of the resultset</li><li class="md me gu mf b mg nm mi mj mk nn mm mn mo no mq mr ms np mu mv mw nq my mz na nj nk nl bk" id="4ae1"><em class="oy">is_null</em> : 0 if NOT NULL, 1 if NULL</li><li class="md me gu mf b mg nm mi mj mk nn mm mn mo no mq mr ms np mu mv mw nq my mz na nj nk nl bk" id="0fc5"><em class="oy">error</em> : 0 for success, 1 for error</li><li class="md me gu mf b mg nm mi mj mk nn mm mn mo no mq mr ms np mu mv mw nq my mz na nj nk nl bk" id="6edc"><em class="oy">return</em> : value of the current row</li></ul></div></div></div><div class="ab cb nb nc nd ne" role="separator"><span class="nf by bm ng nh ni"></span><span class="nf by bm ng nh ni"></span><span class="nf by bm ng nh"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h2 class="nr ns gu bf nt nu nv dy nw nx ny ea nz mo oa ob oc ms od oe of mw og oh oi oj bk" id="6065">API calls flow chart</h2><figure class="ok ol om on oo pc oz pa paragraph-image"><div class="oz pa pb"><picture><source sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 184px" srcset="https://miro.medium.com/v2/resize:fit:640/format:webp/1*kXq6pidBPkxQwWrR6kT0-w.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*kXq6pidBPkxQwWrR6kT0-w.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*kXq6pidBPkxQwWrR6kT0-w.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*kXq6pidBPkxQwWrR6kT0-w.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*kXq6pidBPkxQwWrR6kT0-w.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*kXq6pidBPkxQwWrR6kT0-w.png 1100w, https://miro.medium.com/v2/resize:fit:368/format:webp/1*kXq6pidBPkxQwWrR6kT0-w.png 368w" type="image/webp"/><source data-testid="og" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 184px" srcset="https://miro.medium.com/v2/resize:fit:640/1*kXq6pidBPkxQwWrR6kT0-w.png 640w, https://miro.medium.com/v2/resize:fit:720/1*kXq6pidBPkxQwWrR6kT0-w.png 720w, https://miro.medium.com/v2/resize:fit:750/1*kXq6pidBPkxQwWrR6kT0-w.png 750w, https://miro.medium.com/v2/resize:fit:786/1*kXq6pidBPkxQwWrR6kT0-w.png 786w, https://miro.medium.com/v2/resize:fit:828/1*kXq6pidBPkxQwWrR6kT0-w.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*kXq6pidBPkxQwWrR6kT0-w.png 1100w, https://miro.medium.com/v2/resize:fit:368/1*kXq6pidBPkxQwWrR6kT0-w.png 368w"/><img alt="" class="bh lk pd c" height="299" loading="eager" role="presentation" width="184"/></picture></div><figcaption class="pe ff pf oz pa pg ph bf b bg z du">Internal flow of UDF function calls during query execution</figcaption></figure></div></div></div><div class="ab cb nb nc nd ne" role="separator"><span class="nf by bm ng nh ni"></span><span class="nf by bm ng nh ni"></span><span class="nf by bm ng nh"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h2 class="nr ns gu bf nt nu nv dy nw nx ny ea nz mo oa ob oc ms od oe of mw og oh oi oj bk" id="8973">Real life exemple : deploying a language-agnostic fuzzy matching algorithm (aka Natural Language Processing algorithm)</h2><p class="pw-post-body-paragraph md me gu mf b mg pi mi mj mk pj mm mn mo pk mq mr ms pl mu mv mw pm my mz na gn bk" id="6cb5">At a former position, we encountered a unique challenge : the need to match Arabic names that have been transliterated into the Latin alphabet. This transliteration can result in numerous spelling variations due to differences in phonetic interpretations. Traditional phonetic algorithms like Soundex proved inadequate for this task because they are very english centric and do not account for the nuances of transliterated scripts. To address this issue, we explored natural language processing (NLP) algorithms that offer language-agnostic fuzzy matching capabilities. Our evaluation focused on two prominent techniques: Double Metaphone and Levenshtein distance.</p><p class="pw-post-body-paragraph md me gu mf b mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na gn bk" id="6473"><a class="af io" href="https://en.wikipedia.org/wiki/Metaphone" rel="noopener ugc nofollow" target="_blank">Double Metaphone</a> is a phonetic algorithm that generates two codes for each word, capturing variations in pronunciation. By focusing on phonetic similarity rather than exact spelling, Double Metaphone provided a robust way to match names that sounded alike but were spelled differently. Yet it still exhibits a strong US-centric bias, making it struggling with transliteration from non-latin scripts and phonemes that are absent from the english language.</p><p class="pw-post-body-paragraph md me gu mf b mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na gn bk" id="37c8">On the other hand, <a class="af io" href="https://en.wikipedia.org/wiki/Levenshtein_distance" rel="noopener ugc nofollow" target="_blank">Levenshtein distance</a> measures the minimum number of single-character edits needed to transform one string into another, making it very effective for detecting typographical errors and minor spelling variations. In our context, it helped identify names that were similar in structure but had slight differences due to transliteration inconsistencies.</p><p class="pw-post-body-paragraph md me gu mf b mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na gn bk" id="9993">By choosing Levenshtein distance, we were able to create a truly robust and language-agnostic solution for matching transliterated Arabic names, addressing this unique challenge without relying on wrong phonetic assumptions.</p><p class="pw-post-body-paragraph md me gu mf b mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na gn bk" id="87d5">Let’s turn our attention to the implementation side of things. Initially, I implemented the <a class="af io" href="https://github.com/SylvainA77/levenshtein-udf/blob/master/levenshteinSP.sql" rel="noopener ugc nofollow" target="_blank">Levenshtein algorithm using SQL/PSM</a> for testing purposes. While the results were accurate, the performance was lacking, with each match taking approximately one second. Given that we needed to match several thousand names daily, this approach didn’t meet our performance requirements. I then explored the use of user-defined functions (UDFs) and decided to <a class="af io" href="https://github.com/SylvainA77/levenshtein-udf/blob/master/levenshteinUDF.c" rel="noopener ugc nofollow" target="_blank">adapt a Levenshtein library into a UDF</a>. This involved creating the necessary headers and wrapper functions (<code class="cx pn po pp oq b">levenshteinratio_init()</code> and <code class="cx pn po pp oq b">levenshteinratio_deinit()</code>). The next step was to compile the shared library :</p><pre class="ok ol om on oo op oq or bp os bb bk"><span class="ot ns gu oq b bg ou ov l ow ox" id="1616">gcc -o /PATH/TO/levenshtein.so levenshteinUDF.c `mysql_config --cflags` -shared -fPIC</span></pre><p class="pw-post-body-paragraph md me gu mf b mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na gn bk" id="c1d7">After compilation, I deployed the function to the plugin directory :</p><pre class="ok ol om on oo op oq or bp os bb bk"><span class="ot ns gu oq b bg ou ov l ow ox" id="86ef">cp /PATH/TO/levenshtein.so /usr/lib64/mysql/plugin<br/>chown -R mysql: /usr/lib64/mysql/plugin/<br/>chmod 660 /usr/lib64/mysql/plugin/levenshtein.so</span></pre><p class="pw-post-body-paragraph md me gu mf b mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na gn bk" id="67de">Finally, I created the SQL function call :</p><pre class="ok ol om on oo op oq or bp os bb bk"><span class="ot ns gu oq b bg ou ov l ow ox" id="c811">CREATE FUNCTION levenshtein_ratio RETURNS REAL SONAME `levenshtein.so`;</span></pre><p class="pw-post-body-paragraph md me gu mf b mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na gn bk" id="0b2c">Upon verification, the results remained consistent with the original implementation, but with a significantly improved response time of about 1 millisecond per match, which was matching all of our requirements.</p><h2 class="nr ns gu bf nt nu nv dy nw nx ny ea nz mo oa ob oc ms od oe of mw og oh oi oj bk" id="dce6">Conclusion</h2><p class="pw-post-body-paragraph md me gu mf b mg pi mi mj mk pj mm mn mo pk mq mr ms pl mu mv mw pm my mz na gn bk" id="1d25"><a class="af io" href="https://mariadb.com/kb/en/user-defined-functions/" rel="noopener ugc nofollow" target="_blank">User-defined functions (UDFs)</a> offer a powerful way to extend database functionality, allowing developers to implement custom logic directly within the database kernel. While traditionally written in C, modern database systems are expanding their UDF capabilities to include languages like Go and Rust. These newer options provide developers with more choices, balancing performance, safety, and ease of use. Rust, in particular, has gained traction for UDF development due to its focus on memory safety and performance. Meanwhile, Go’s simplicity and strong concurrency support make it an attractive option for certain types of UDFs. As database systems continue to evolve, the landscape of UDF development is likely to expand further, offering developers more tools to create efficient, secure, and tailored database functions. Whether choosing <a class="af io" href="https://github.com/SylvainA77/levenshtein-udf" rel="noopener ugc nofollow" target="_blank">C for its low-level control</a> (like me), <a class="af io" href="https://mariadb.org/writing-user-defined-functions-in-rust/" rel="noopener ugc nofollow" target="_blank">Rust for its safety guarantees</a> (as Trevor Gross, contributor to the MariaDB Foundation), or <a class="af io" href="https://vettabase.com/writing-user-defined-functions-for-mariadb-in-go/" rel="noopener ugc nofollow" target="_blank">Go for its simplicity</a> (as Richard Bensley, formerly from Vettabase), developers now have a range of options to implement UDFs that best suit their specific needs and expertise.</p></div></div></div></div></section></div></div></article>
